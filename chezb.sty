\ProvidesPackage{chezb}[2017/09/09]
\usepackage{amsmath, amssymb, amsthm}

% We include "chez" in all of these to make sure
% that they do not conflict with any other packages
\newif\ifchezsetup   \chezsetuptrue
\newif\ifchezshorts  \chezshortstrue
\newif\ifchezasy     \chezasytrue

\DeclareOption{nosetup}{\chezasyfalse}
\DeclareOption{noshortcuts}{\chezshortsfalse}
\DeclareOption{noasy}{\chezasyfalse}
\DeclareOption{noauthor}{\chezauthorfalse}
\DeclareOption{nodate}{\chezdatefalse}

\newif\ifchezbeamernobutton \chezbeamernobuttontrue
\newif\ifchezbeamernice     \chezbeamernicetrue
\newif\ifchezallsmallcaps   \chezallsmallcapstrue
\newif\ifchezthm            \chezthmtrue

\DeclareOption{buttons}{\chezbeamernobuttonfalse}
\DeclareOption{nobeamernice}{\chezbeamernicefalse}
\DeclareOption{noallsmallcaps}{\chezallsmallcapsfalse}
\DeclareOption{nothms}{\chezthmfalse}

\ProcessOptions\relax

\usepackage{chezbase}

\ifchezsetup
\ifchezbeamernobutton
  \beamertemplatenavigationsymbolsempty
\fi

\ifchezthm
  \newtheorem{proposition}[theorem]{Proposition}
  \newtheorem{answer}[theorem]{Answer}
  \newtheorem{case}[theorem]{Case}
  \newtheorem{claim}[theorem]{Claim}
  \newtheorem{conjecture}[theorem]{Conjecture}
  \newtheorem{exercise}[theorem]{Exercise}
  \newtheorem{idea}[theorem]{Idea}
  \newtheorem{question}[theorem]{Question}
  
  \definecolor{chezdarkred}{rgb}{0.523, 0.148, 0.148}
  \definecolor{chezpalered}{rgb}{0.949, 0.910, 0.910}
  \definecolor{chezdarkblue}{rgb}{0.148, 0.148, 0.523}
  \definecolor{chezpaleblue}{rgb}{0.910, 0.910, 0.949}
  \definecolor{chezdarkgreen}{rgb}{0.148, 0.523, 0.148}
  \definecolor{chezpalegreen}{rgb}{0.910, 0.949, 0.910}
  
  \AtBeginEnvironment{theorem}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{lemma}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{proposition}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{corollary}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{conjecture}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{definition}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{example}{
    \setbeamercolor{block title example}{fg=white, bg=chezdarkgreen}
    \setbeamercolor{block body example}{fg=black, bg=chezpalegreen}
  }
  
  \AtBeginEnvironment{proof}{
    \setbeamercolor{block title}{fg=white, bg=chezdarkblue}
    \setbeamercolor{block body}{fg=black, bg=chezpaleblue}
  }
  
  \AtBeginEnvironment{alert}{
    \setbeamercolor{block title alert}{fg=white, bg=chezdarkred}
    \setbeamercolor{block body alert}{fg=black, bg=chezpalered}
  }
\fi

\ifchezbeamernice
  \IfFileExists{beamerthememetropolis.sty}{
    \usepackage[sfdefault, lf]{FiraSans}
    \usetheme[block=fill, background=dark]{metropolis}
    \ifchezallsmallcaps
      \metroset{titleformat = allsmallcaps}
      \setbeamerfont{title}{size=\Large, series=\mdseries}
      \setbeamerfont{section title}{size=\Large, series=\mdseries}
      \setbeamerfont{block title}{size=\normalsize, series=\mdseries}
      \setbeamerfont{block title alerted}{size=\normalsize, series=\mdseries}
      \setbeamerfont{frametitle}{size=\large, series=\mdseries}
      \setbeamerfont{caption name}{series=\mdseries}
      \setbeamerfont{description item}{series=\mdseries}
      \setbeamerfont{standout}{size=\Large, series=\mdseries}
    \fi
  }{
    \usetheme{Rochester}
    \usecolortheme{whale}
  }
\else
  \usetheme{Rochester}
  \usecolortheme{whale}
\fi
\fi
