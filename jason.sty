\ProvidesPackage{jason}[2017/01/21]
\usepackage{amsmath,amssymb,amsthm}

% We include "jason" in all of these to make sure
% that they do not conflict with any other packages
\newif\ifjasonarticle \jasonarticletrue
\newif\ifjasonbeamer  \jasonbeamerfalse
\DeclareOption{beamer}{\jasonarticlefalse\jasonbeamertrue}

\newif\ifjasonsetup   \jasonsetuptrue
\newif\ifjasonshorts  \jasonshortstrue
\newif\ifjasonasy     \jasonasytrue
	\newif\ifjasonasypredef \jasonasypredeftrue
\newif\ifjasonauthor  \jasonauthortrue
\newif\ifjasondate  \jasondatetrue
\newif\ifjasoncolor \jasoncolortrue

\DeclareOption{nosetup}{\jasonasyfalse}
\DeclareOption{noshortcuts}{\jasonshortsfalse}
\DeclareOption{noasy}{\jasonasyfalse}
\DeclareOption{noasypredef}{\jasonasypredeffalse}
\DeclareOption{noauthor}{\jasonauthorfalse}
\DeclareOption{nodate}{\jasondatefalse}
\DeclareOption{nocolor}{\jasoncolorfalse}

% ARTICLE
\newif\ifjasonmargins   \jasonmarginstrue
\newif\ifjasonspacing   \jasonspacingtrue
\newif\ifjasonfont      \jasonfonttrue
\newif\ifjasontitling   \jasontitlingtrue
\newif\ifjasonfancy     \jasonfancytrue
\newif\ifjasonheadrule  \jasonheadruletrue
\newif\ifjasonthm       \jasonthmtrue
\newif\ifjasonsectthms  \jasonsectthmsfalse
\newif\ifjasonboxedthms \jasonboxedthmstrue
\newif\ifjasonref       \jasonreftrue
\newif\ifjasoncode      \jasoncodefalse

\DeclareOption{normalmargins}{\jasonmarginsfalse}
\DeclareOption{normalspacing}{\jasonspacingfalse}
\DeclareOption{normalfont}{\jasonfontfalse}
\DeclareOption{normaltitling}{\jasontitlingfalse}
\DeclareOption{nofancy}{\jasonfancyfalse}
\DeclareOption{noheadrule}{\jasonheadrulefalse}
\DeclareOption{nothms}{\jasonthmfalse}
\DeclareOption{sectthms}{\jasonsectthmstrue}
\DeclareOption{regularthms}{\jasonboxedthmsfalse}
\DeclareOption{noref}{\jasonreffalse}
\DeclareOption{href}{\jasonhreftrue}
\DeclareOption{listings}{\jasoncodetrue}

% BEAMER
\newif\ifjasonbeamernobutton  \jasonbeamernobuttontrue
\newif\ifjasonbeamersimple    \jasonbeamersimplefalse

\DeclareOption{nobuttons}{\jasonbeamernobuttontrue}
\DeclareOption{simple}{\jasonbeamersimpletrue}

\ProcessOptions\relax

\ifjasonshorts
	% Symbols
	\newcommand{\eps}{\varepsilon}
	\newcommand{\dang}{\measuredangle} %% Directed angle
	%\renewcommand{\iff}{\Leftrightarrow}
	%\renewcommand{\implies}{\Rightarrow}
	\def\dg{^\circ}
	\def\ii{\item}
	\def\half{\frac{1}{2}}
	\def\st{\; \middle\vert \;}
	
	% Arguments
	\newcommand{\cbrt}[1]{\sqrt[3]{#1}}
	\newcommand{\ol}[1]{\overline{#1}}
	\newcommand{\ul}[1]{\underline{#1}}
	\newcommand{\ray}[1]{\overrightarrow{#1}}
	\newcommand{\seg}[1]{\ol{#1}}
	\newcommand{\arc}[1]{\wideparen{#1}}
	\newcommand{\vocab}[1]{\textbf{\color{blue}\boldmath #1}}
	
	% Operators
	\DeclareMathOperator{\cis}{cis}
	\DeclareMathOperator{\lcm}{lcm}
	\newcommand{\Mod}[1]{\ (\text{mod}\ #1)}
	\renewcommand{\mod}[1]{\ \text{mod}\ #1}
	
	% Commands
	\newcommand{\NewPage}{\vfill\eject}
	\newcommand{\supnewline}{\leavevmode\par\vspace*{\dimexpr-3pt-\parskip-\baselineskip}}
	\newcommand{\mailto}[1]{\href{mailto:#1}{\texttt{#1}}}
	\newcommand{\hrulebar}{
		\par\hspace{\fill}\rule{0.95\linewidth}{.7pt}\hspace{\fill}
		\par\nointerlineskip \vspace{\baselineskip}
	}
	
	% Sets
	\def\CC{\mathbb C}
	\def\FF{\mathbb F}
	\def\NN{\mathbb N}
	\def\QQ{\mathbb Q}
	\def\RR{\mathbb R}
	\def\ZZ{\mathbb Z}
	
	% Inequalities
	\newcommand{\cycsum}{\sum_{\mathrm{cyc}}}
	\newcommand{\symsum}{\sum_{\mathrm{sym}}}
	\newcommand{\cycprod}{\prod_{\mathrm{cyc}}}
	\newcommand{\symprod}{\prod_{\mathrm{sym}}}
	
	% for delimiters
	\usepackage{mathtools}
	
	% syntactically-named delimiters
	\DeclarePairedDelimiter{\braces}{\{}{\}}
	\DeclarePairedDelimiter{\parens}{(}{)}
	\DeclarePairedDelimiter{\brackets}{[}{]}
	\DeclarePairedDelimiter{\angles}{\langle}{\rangle}
	\DeclarePairedDelimiter{\verts}{\lvert}{\rvert}
	\DeclarePairedDelimiter{\Verts}{\lVert}{\rVert}
	\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
	\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
	
	% semantically-named delimiters
	\newcommand{\set}{\braces}
	\newcommand{\abs}{\verts}
	\newcommand{\size}{\verts}
	\newcommand{\norm}{\Verts}
	\newcommand{\tuple}{\angles}
\fi

% Asymptote
\ifjasonasy
	\PassOptionsToPackage{noplaybutton}{media9}
	\usepackage[inline]{asymptote}
	
	\ifjasonasypredef
		\begin{asydef}
			import olympiad; import cse5;
			pointpen = pathpen = pathfontpen = anglepen = anglefontpen = black;
			pointfontsize = 9; defaultpen(fontsize(9pt));
			usepackage("amsmath"); usepackage("amssymb");
			size(7cm);
			
			pen n_purple = rgb(0.7,0.4,1),
				n_blue = rgb(0,0.6,1),
				n_green = rgb(0,0.4,0),
				n_orange = rgb(1,0.4,0.1),
				n_red = rgb(1,0.2,0.4);
			
			pair bary(real a, real b, real c, pair X, pair Y, pair Z){
				return (a*X + b*Y + c*Z)/(a + b + c);
			}
			
			pair excenter(pair A, pair B, pair C){
				return bary(-d(B,C), d(C,A), d(A,B), A, B, C);
			}
			
			path excircle(pair A, pair B, pair C){
				return CP(excenter(A,B,C),foot(excenter(A,B,C),B,C));
			}
			
			pair A = dir(110), B = dir(210), C = dir(330), D = dir(20),
				O = origin, H = orthocenter(A,B,C), I = incenter(A,B,C);
		\end{asydef}
	\fi
\fi

\ifjasonsetup
% % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % GLOBAL % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % %
\PassOptionsToPackage{svgnames,dvipsnames}{xcolor}
\usepackage{microtype}
\usepackage{nccmath}
\usepackage{graphicx}
\usepackage{endnotes}
\usepackage{float}
\usepackage[obeyFinal,textsize=scriptsize]{todonotes}

% makes \oint circle smaller
\let\oldoint\ointop
\usepackage{esint}
\renewcommand{\oint}{\oldoint\nolimits}

% Set up Author
\ifjasonauthor
	\author{Jason Chen}
\fi

% % % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % ARTICLE % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % % %
\ifjasonarticle
	% must stay in this order:
	\ifjasonref
		\usepackage{hyperref}
		\usepackage{cleveref}
	\fi
	
	\newenvironment{solution}{\begin{proof}[Solution]}{\end{proof}}
	
	\ifjasonmargins
		\PassOptionsToPackage{margin=2.5cm}{geometry}
	\fi
	\usepackage{geometry}
	
	% Sans Serif Headings
	\usepackage{sectsty} % \allsectionsfont
	\ifjasonfont
		\allsectionsfont{\sffamily}
	\fi
	
	\usepackage{enumitem} % \setitemize
	\ifjasonspacing
		\usepackage[nodisplayskipstretch,onehalfspacing]{setspace}
		
		\usepackage{titlesec} % titlespacing
		\titlespacing{\paragraph}{0pt}{0.3em}{0.5em}
		
		\allowdisplaybreaks
		
		%\let\oldcases\cases
		%\let\oldendcases\endcases
		%\renewenvironment{cases}{\setstretch{1}\oldcases}{\oldendcases}
		\AtBeginDocument{
			\setlength{\belowdisplayskip}{5pt}
			\setlength{\belowdisplayshortskip}{2pt}
			\setlength{\abovedisplayskip}{5pt}
			\setlength{\abovedisplayshortskip}{2pt}
		}
		
		\setitemize{itemsep=0pt, topsep=0pt}
		\renewcommand\labelitemi{\raisebox{1.5pt}{\tiny$\bullet$}}
		\renewcommand{\arraystretch}{0.8}
	\fi
	
	%Titling
	\ifjasontitling
		\usepackage{titling}
		
		\ifjasonfont
			\pretitle{
				\vspace{-30pt}
				\begin{center}
					\Large
					\bfseries
					\ifjasonfont \sffamily \fi
			}
		\fi
		\posttitle{\\ \vspace{-0.1em}\end{center}}
		
		\preauthor{\begin{center} \scshape}
		\postauthor{\\ \vspace{-0.2em} \end{center}}
		
		\predate{\begin{center} \small}
		\postdate{\\ \end{center}}
		
		\providecommand{\thesubtitle}{}
		\newcommand{\subtitle}[1]{
			\renewcommand{\thesubtitle}{#1}
			\posttitle{
				\\ \vspace{0pt}
				\end{center}
				\begin{center}
					\vspace{-0.8em}
					\large
					\bfseries
					\ifjasonfont \sffamily \fi
					\thesubtitle
				\end{center}
				\vspace{-1.5em}
			}
		}
		
		\ifjasonauthor
			\author{Jason Chen}
		\fi
		
		\ifjasondate\else
			\date{~\vspace{-5ex}}
		\fi
	\fi
	
	\ifjasonfancy
		\usepackage{fancyhdr}
		\pagestyle{fancy}
		\setlength{\headheight}{36pt}
		
		% Setup Fancy Headers
		\ifjasonheadrule
			\renewcommand{\headrulewidth}{0.5pt}
		\else
			\renewcommand{\headrulewidth}{0pt}
		\fi
		\renewcommand{\footrulewidth}{0pt}
		
		\ifjasontitling
			\lhead{\theauthor}
		\fi
		
		\chead{}
		\rhead{\nouppercase{\leftmark}}
		\lfoot{}
		\cfoot{\thepage}
		\rfoot{}
	\fi
	
	\ifjasonboxedthms
		\usepackage{xcolor}
		\usepackage{thmtools}
		\usepackage[framemethod=TikZ]{mdframed}
		
		\ifjasoncolor
			\mdfdefinestyle{mdbluebox}{%
				roundcorner = 2pt,
				linewidth=1pt,
				skipabove=5pt,
				innerbottommargin=9pt,
				nobreak=false,
				skipbelow=2pt,
				linecolor=Blue,
				backgroundcolor=DodgerBlue!5,
			}
			\declaretheoremstyle[
				headfont=\sffamily\bfseries\color{MediumBlue},
				mdframed={style=mdbluebox},
				headpunct={\\[3pt]},
				postheadspace={0pt}
			]{thmbluebox}
 	
			\mdfdefinestyle{mdrecbox}{%
				roundcorner = 2pt,
				linewidth=0.5pt,
				skipabove=5pt,
				frametitleaboveskip=5pt,
				frametitlebelowskip=0pt,
				skipbelow=2pt,
				frametitlefont=\bfseries,
				innertopmargin=4pt,
				innerbottommargin=8pt,
				linecolor=Green,
				backgroundcolor=green!5,
			}
			\declaretheoremstyle[
				headfont=\bfseries\color{Green},
				mdframed={style=mdrecbox},
				headpunct={\\[3pt]},
				postheadspace={0pt},
				preheadhook={~\vspace{-6pt}},
			]{thmrecbox}
		\else
			\mdfdefinestyle{mdbluebox}{%
				roundcorner = 2pt,
				linewidth=1pt,
				skipabove=5pt,
				innerbottommargin=9pt,
				nobreak=false,
				skipbelow=2pt,
				linecolor=black,
			}
			\declaretheoremstyle[
			headfont=\sffamily\bfseries,
			mdframed={style=mdbluebox},
			headpunct={\\[3pt]},
			postheadspace={0pt}
			]{thmbluebox}
			
			\mdfdefinestyle{mdrecbox}{%
				roundcorner = 2pt,
				linewidth=0.5pt,
				skipabove=5pt,
				frametitleaboveskip=5pt,
				frametitlebelowskip=0pt,
				skipbelow=2pt,
				frametitlefont=\bfseries,
				innertopmargin=4pt,
				innerbottommargin=8pt,
				linecolor=black,
			}
			\declaretheoremstyle[
			headfont=\bfseries,
			mdframed={style=mdrecbox},
			headpunct={\\[3pt]},
			postheadspace={0pt},
			preheadhook={~\vspace{-6pt}},
			]{thmrecbox}
		\fi
	\fi
	
	\ifjasonthm
		\theoremstyle{plain}
		
		\ifjasonboxedthms
			\ifjasonsectthms
				\declaretheorem[%
				style=thmbluebox,name=Theorem,numberwithin=section]{theorem}
			\else
				\declaretheorem[%
				style=thmbluebox,name=Theorem]{theorem}
			\fi
			\declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemma}
			\declaretheorem[style=thmbluebox,name=Proposition,sibling=theorem]{proposition}
			\declaretheorem[style=thmbluebox,name=Corollary,sibling=theorem]{corollary}
			\declaretheorem[style=thmbluebox,name=Theorem,numbered=no]{theorem*}
			\declaretheorem[style=thmbluebox,name=Lemma,numbered=no]{lemma*}
			\declaretheorem[style=thmbluebox,name=Proposition,numbered=no]{proposition*}
			\declaretheorem[style=thmbluebox,name=Corollary,numbered=no]{corollary*}
		\else
			\ifjasonsectthms
				\newtheorem{theorem}{Theorem}[section]
			\else
				\newtheorem{theorem}{Theorem}
			\fi
			\newtheorem{lemma}[theorem]{Lemma}
			\newtheorem{proposition}[theorem]{Proposition}
			\newtheorem{corollary}[theorem]{Corollary}
			\newtheorem*{theorem*}{Theorem}
			\newtheorem*{lemma*}{Lemma}
			\newtheorem*{proposition*}{Proposition}
			\newtheorem*{corollary*}{Corollary}
		\fi
		
		% Def-style Theorems
		\theoremstyle{definition}
		
		\ifjasonboxedthms
			\declaretheorem[style=thmbluebox,name=Algorithm,sibling=theorem]{algorithm}
		\else
			\newtheorem{algorithm}[theorem]{Algorithm}
			\newtheorem*{algorithm*}{Algorithm}
		\fi
		
		\newtheorem{answer}[theorem]{Answer}
		\newtheorem{case}[theorem]{Case}
		\newtheorem{claim}[theorem]{Claim}
		\newtheorem{conjecture}[theorem]{Conjecture}
		\newtheorem{definition}[theorem]{Definition}
		\newtheorem{exercise}[theorem]{Exercise}
		\newtheorem{fact}[theorem]{Fact}
		\newtheorem{problem}[theorem]{Problem}
		\newtheorem{idea}[theorem]{Idea}
		\newtheorem{question}[theorem]{Question}
		
		\newtheorem*{answer*}{Answer}
		\newtheorem*{case*}{Case}
		\newtheorem*{claim*}{Claim}
		\newtheorem*{conjecture*}{Conjecture}
		\newtheorem*{definition*}{Definition}
		\newtheorem*{exercise*}{Exercise}
		\newtheorem*{fact*}{Fact}
		\newtheorem*{joke*}{Joke}
		\newtheorem*{problem*}{Problem}
		\newtheorem*{idea*}{Idea}
		\newtheorem*{question*}{Question}
		
		\ifjasonboxedthms
			\declaretheorem[style=thmrecbox,name=Example,sibling=theorem]{example}
			\declaretheorem[style=thmrecbox,name=Example,numbered=no]{example*}
		\else
			\newtheorem{example}[theorem]{Example}
			\newtheorem*{example*}{Example}
		\fi
		
		% Remark-style theorems
		%\theoremstyle{remark}
		%\newtheorem{note}[theorem]{Note} % note theorem-environment conflicts with endnotes
		%\newtheorem*{note*}{Note}
		\newtheorem{remark}[theorem]{Remark}
		\newtheorem*{remark*}{Remark}
	\fi
	
	\ifjasoncode
		\usepackage{minted}
		\usepackage{accsupp} % prevents selection of line numbers
		\let\oldfancyVerbLine\theFancyVerbLine
		\renewcommand{\theFancyVerbLine}{\BeginAccSupp{ActualText={}}\oldfancyVerbLine\EndAccSupp{}}
	\fi
\fi

% % % % % % % % % % % % % % % % % % % % % % %
% % % % % % % % % % BEAMER % % % % % % % % % %
% % % % % % % % % % % % % % % % % % % % % % %
\ifjasonbeamer
	\ifjasonbeamernobutton
		\beamertemplatenavigationsymbolsempty
	\fi
	
	\ifjasonbeamersimple
		\usetheme{default}
	\else
		\usetheme{Rochester}
		\usecolortheme{whale}
	\fi
\fi

\fi
